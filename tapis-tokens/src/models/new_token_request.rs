/*
 * Tokens API
 *
 * Manage Tapis Tokens.
 *
 * The version of the OpenAPI document: 1
 * Contact: cicsupport@tacc.utexas.edu
 * Generated by: https://openapi-generator.tech
 */

use crate::models;
use serde::{Deserialize, Serialize};

#[derive(Clone, Default, Debug, PartialEq, Serialize, Deserialize)]
pub struct NewTokenRequest {
    /// The type of account (user or service) represented by the token.
    #[serde(rename = "account_type")]
    pub account_type: AccountType,
    /// The tenant associated with the token to be generated.
    #[serde(rename = "token_tenant_id")]
    pub token_tenant_id: String,
    /// The username associated with the token to be generated.
    #[serde(rename = "token_username")]
    pub token_username: String,
    /// The site_id for the site where this token will be used. Only used when account_type is \"service\". If not provided, the site_id for the token_tenant_id will be used.
    #[serde(rename = "target_site_id", skip_serializing_if = "Option::is_none")]
    pub target_site_id: Option<String>,
    /// Whether the generated token should be a delegation token.
    #[serde(rename = "delegation_token", skip_serializing_if = "Option::is_none")]
    pub delegation_token: Option<bool>,
    /// The tenant_id associated with the subject who used a delegation authority in creating the delegation token.
    #[serde(rename = "delegation_sub_tenant_id", skip_serializing_if = "Option::is_none")]
    pub delegation_sub_tenant_id: Option<String>,
    /// The username associated with the subject who used a delegation authority in creating the delegation token.
    #[serde(rename = "delegation_sub_username", skip_serializing_if = "Option::is_none")]
    pub delegation_sub_username: Option<String>,
    /// The TTL, in seconds, for the generated token.
    #[serde(rename = "access_token_ttl", skip_serializing_if = "Option::is_none")]
    pub access_token_ttl: Option<i32>,
    /// Whether to also generate a refresh token.
    #[serde(rename = "generate_refresh_token", skip_serializing_if = "Option::is_none")]
    pub generate_refresh_token: Option<bool>,
    /// The TTL, in seconds, for the refresh token (if generated).
    #[serde(rename = "refresh_token_ttl", skip_serializing_if = "Option::is_none")]
    pub refresh_token_ttl: Option<i32>,
    /// JSON object of additional claims to add to the standard claims issued with the token. Note - standard claims cannot be modified through this parameter.
    #[serde(rename = "claims", skip_serializing_if = "Option::is_none")]
    pub claims: Option<serde_json::Value>,
}

impl NewTokenRequest {
    pub fn new(account_type: AccountType, token_tenant_id: String, token_username: String) -> NewTokenRequest {
        NewTokenRequest {
            account_type,
            token_tenant_id,
            token_username,
            target_site_id: None,
            delegation_token: None,
            delegation_sub_tenant_id: None,
            delegation_sub_username: None,
            access_token_ttl: None,
            generate_refresh_token: None,
            refresh_token_ttl: None,
            claims: None,
        }
    }
}
/// The type of account (user or service) represented by the token.
#[derive(Clone, Copy, Debug, Eq, PartialEq, Ord, PartialOrd, Hash, Serialize, Deserialize)]
pub enum AccountType {
    #[serde(rename = "user")]
    User,
    #[serde(rename = "service")]
    Service,
}

impl Default for AccountType {
    fn default() -> AccountType {
        Self::User
    }
}

